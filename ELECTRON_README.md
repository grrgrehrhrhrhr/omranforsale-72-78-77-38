# تطبيق عمران للمبيعات - إصدار سطح المكتب

## نظرة عامة
تم تحويل تطبيق عمران للمبيعات إلى تطبيق سطح مكتب يعمل بدون إنترنت باستخدام Electron.

## المتطلبات
- Node.js (الإصدار 16 أو أحدث)
- npm أو yarn

## التشغيل في وضع التطوير

### الطريقة الأولى: استخدام ملف batch
```bash
# تشغيل الملف
run-electron-dev.bat
```

### الطريقة الثانية: الأوامر اليدوية
```bash
# تثبيت المتطلبات
npm install

# تشغيل الخادم التطويري
npm run dev

# في terminal آخر، تشغيل Electron
electron .
```

## بناء التطبيق للإنتاج

### الطريقة الأولى: استخدام ملف batch
```bash
# تشغيل الملف
build-electron.bat
```

### الطريقة الثانية: الأوامر اليدوية
```bash
# بناء تطبيق React
npm run build

# بناء تطبيق Windows
npx electron-builder --win

# بناء تطبيق Mac (على macOS فقط)
npx electron-builder --mac

# بناء تطبيق Linux
npx electron-builder --linux
```

## ملفات الإخراج
بعد البناء، ستجد الملفات في مجلد `dist-electron`:
- `omran-sales-setup-[version].exe` - مثبت Windows
- `omran-sales-portable-[version].exe` - نسخة محمولة لا تحتاج تثبيت

## الميزات الخاصة بإصدار سطح المكتب

### 1. العمل بدون إنترنت
- جميع البيانات محفوظة محلياً
- لا يحتاج اتصال إنترنت للعمل
- نظام نسخ احتياطي محلي

### 2. أمان البيانات
- تشفير البيانات المحلية
- نظام قفل الجهاز الواحد
- التحقق من سلامة البيانات

### 3. النسخ الاحتياطي
- نسخ احتياطي تلقائي
- حفظ النسخ في مجلد المستندات
- استيراد وتصدير البيانات

### 4. إدارة المستخدمين
- بيانات منفصلة لكل مستخدم
- تبديل بين المستخدمين
- حماية بيانات المستخدم

## استكشاف الأخطاء

### مشكلة: التطبيق لا يبدأ
- تأكد من تثبيت Node.js
- تأكد من تشغيل `npm install` أولاً
- تحقق من وجود مجلد `dist` بعد `npm run build`

### مشكلة: خطأ في البناء
- تأكد من وجود مساحة كافية على القرص
- تأكد من عدم تشغيل برامج مكافحة الفيروسات أثناء البناء
- جرب حذف `node_modules` وإعادة `npm install`

### مشكلة: التطبيق يعمل لكن البيانات لا تحفظ
- تحقق من صلاحيات الكتابة في مجلد التطبيق
- تحقق من مساحة القرص المتاحة

## الملفات المهمة
- `electron.js` - الملف الرئيسي لـ Electron
- `electron-preload.js` - سكريبت preload للأمان
- `electron-builder.json` - إعدادات البناء
- `src/utils/userDataManager.ts` - إدارة بيانات المستخدمين
- `src/utils/storage.ts` - نظام التخزين المحلي

## ملاحظات مهمة
1. التطبيق مصمم للعمل على جهاز واحد فقط (نظام قفل)
2. البيانات محفوظة في localStorage + ملفات محلية
3. النسخ الاحتياطية تحفظ في مجلد Documents/OmranBackups
4. التطبيق يدعم Windows و Mac و Linux

## الدعم الفني
في حالة وجود مشاكل، تحقق من:
1. سجلات وحدة التحكم في التطبيق
2. ملفات السجل في مجلد التطبيق
3. إعدادات مكافح الفيروسات